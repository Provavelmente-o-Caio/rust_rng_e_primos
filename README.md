Rewriting an algorithn I previously implemented in python using rust
